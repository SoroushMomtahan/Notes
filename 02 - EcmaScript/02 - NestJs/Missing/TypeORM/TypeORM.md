



![](Pasted%20image%2020240310203214.png)

![](Pasted%20image%2020240310203529.png)

![](Pasted%20image%2020240310203619.png)

![](Pasted%20image%2020240310203734.png)

![](Pasted%20image%2020240310203914.png)

متد `preload` اگر بتونه enitity مربوطه رو با توجه به id که بهش می دیم پیدا کنه کل enitiy ی coffee رو بر میگردونه و اگر نتونه براساس id داده شده چیزی پیدا کنه `undefined` بر میگردونه

>[!tip]
>زمانی که تغییری روی یه entity می دیم ، برای اینکه این تغییر در دیتابیس ثبت بشه از متد `save()` استفاده می کنیم و زمانی که entity ای رو حذف می کنیم باید متد `remove()` رو صدا بزنیم.


![](Pasted%20image%2020240310204347.png)

دقت کنید که متد `findOne()` در خط 44 ، همان متد `findOne()` کلاس CoffeeService هست.

انواع relation بین دو جدول--------------

ارتباط 1 به 1

![](Pasted%20image%2020240310205309.png)

در typeORM برای نشان دادن این نوع ارتباط از دکوراتور `@OneToOne()` استفاده می کنیم.

ارتباط 1 به چند

![](Pasted%20image%2020240310205743.png)

در typeORM برای نشان دادن این نوع از ارتباط از دکوراتور `@OneToMany()` و `@ManyToOne()` استفاده میشه.

ارتباط چند به چند

![](Pasted%20image%2020240310210555.png)

در typeORM برای نشان دادن این نوع از ارتباط از دکوراتور `@ManyToMany()` استفاده میشه.

حالا بیاین طعم و مزه کافی (Flavor) رو یه جدول جدا در نظر بگیریم ، پس یه entity تحت عنوان flavor.entity می سازیم:

![](Pasted%20image%2020240310211017.png)

![](Pasted%20image%2020240310211143.png)
![](Pasted%20image%2020240310212231.png)

دکوراتور `@JoinToTable()` مالک رابطه رو مشخص میکنه

![](Pasted%20image%2020240310212640.png)

حالا باید موجودیت `Flavor` رو بوسیله `TypeOrmModule`  در `CoffeeModule` ثبت (register) کنیم:

![](Pasted%20image%2020240310212848.png)

حالا وقتی برنامه رو run می کنیم ، جدول زیر در دیتابیس مربوطه ایجاد میشه:

![](Pasted%20image%2020240310212957.png)

نکته اینجاست که چون رابطه از نوع چند به چند بوده ، یه جدول سومی هم ایجاد میشه:

![](Pasted%20image%2020240310213111.png)

گفته میشه این جدول رو در حالت production غیر فعال کرد که ساخته نشه !! منظورشو نفهمیدم.


![](Pasted%20image%2020240310213944.png)

حالا اگه request ای ارسال کنیم که لیست coffee ها رو بگیریم ، flavors رو نخواهیم داشت ، برای رفع این مسئله یه option باید به متد های repository اضافه کنیم:


![](Pasted%20image%2020240310213846.png)

![](Pasted%20image%2020240310213856.png)

حالا اگه یه بار دیگه request بزنیم flavors رو هم خواهیم داشت:

![](Pasted%20image%2020240310214017.png)

