![](Pasted%20image%2020240302120111.png)

**سه روش برای ارضای وابستگی در یک کلاس وجود دارد:**

1- create manual instance

2- constructor injection

3- method injection (setter method injection)

>[!tip]
> این Constructor یه متد هست که خودش هنگام ساخت یه کلاس فراخوانی میشه.


قبل از همه بیایم بررسی کنیم که اصلا وابستگی چیه که یه نمونه بخواد نیازمندش بشه؟

مثلا یک تلویزیون برای روشن شدنش نیازمند ویژگی ای به اسم برقه

انسان برای صحبت کردنش نیازمند ویژگی ای به اسم زبان هست

در برای باز و بسته شدنش نیازمند ویژگی ای به اسم لولا هست

ماشین برای حرکت کردنش نیازمند ویژگی ای به اسم بنزینه

وجه مشترک تمام جملات بالا **ویژگی** هست

یعنی اگر انسان و در و ماشین رو ، هر کدام یه نمونه از کلاساشون در نظر بگیریم ، این نمونه ها نیاز به ویژگی هایی دارند

حالا اگه بخوایم از نگاه برنامه نویسی صحبت کنیم ، این ویژگی ها ، در واقع ظرف هایی هستند که می تونن از جنس string ، number و یا حتی کلاسی دیگر باشند ؛ یعنی مثلا برق در منطق برنامه ما شاید یه string و یا یه نمونه از کلاس برق باشه (یعنی همه چی به منطق برنامه ما بستگی داره که اون ویژگی از چه جنسی باشه پس روی این ویژگی الان حساسیت نشون ندین)

خب بر گردیم به عقب ، گفتیم که اگر انسان و در و ماشین رو ، هر کدام یه نمونه از کلاساشون در نظر بگیریم ، این نمونه ها نیاز به ویژگی هایی دارند

اگر در همان زمان ایجاد نمونه از کلاس مورد نظر ، نیاز به تامین این ویژگی ها باشد (مثلا مفهوم کلاس تلویزیون به گونه ای باشد که در هنگام ساخته شدن باید ویژگی برق رو داشته باشد ) می بایست در constructor کلاس تعیین کنیم که کلاس ما در زمان ایجاد نمونه به این ویژگی ها نیازمنده

مثلا انسان برای بوجود آمدن نیاز به ویژگی به اسم قلب داره ، پس این ویژگی در زمان ساخته شدن نمونه ای از کلاس انسان لازمه

قبلش بیایم بررسی کنیم که چرا اصلا یک نمونه برای ایجاد شدنش نیازمند وابستگی هایی میشه

در دنیای واقعی نمی تونیم همه کار ها رو با استفاده از تنها یک طبقه بند انجام داد.

یا بعضی از کار ها هر چند هم که به هم نزدیک باشند اما ممکنه به علت گستردگی شون ، نشه اونارو در قالب یک کلاس گنجاند.

یه کلاس می تونه به کلاسی دیگر وابسته باشه که این وابستگی می تونه به دو صورت باشه یا اینکه کلاس وابسته مستقیما شی ای از کلاس مستقل ساخته باشه و یا اینکه وظیفه ساخت شی رو برعهده framewoork گذاشته باشه و فقط اعلام کنه که به فلان نمونه از فلان کلاس نیازمنده

وابستگی باید به گونه ای باشد که قابلیت change شدن داشته باشد یعنی تغییر وابستگی یه کلاس بدون درد و خون ریزی بتونه انجام بشه

ارضای وابستگی یک شی بصورت صریح (یعنی ساخت مستقیم شی توسط برنامه نویس ) کار خیلی خوبی نیست.

اینطوری برنامه ما در هم طنییده میشه و توسعه پذیری برنامه سخت میشه.

>[!tip]
>توی php جنریک نداریم و بجاش می تونیم آرایه ای داشته باشیم که میشه با annotation ادیتور phpstorm بگیم از چه جنسی هست.


تفاوت دریافت شی کلاس وابسته در سازنده و دریافت شی کلاس وابسته در متد:

یک انسان به قلب وابسته هست ، پس این انسان در هنگام ایجاد باید نیازمندی به قلبش تامین شود

اما مثلا یک کاربر در زمان ایجاد می تونه بدون کامنت باشه و مثلا متد ایجاد کامنتش به شی ای از کلاس کامنت نیازمند باشه

پس چیزایی که یک نمونه در زمان ایجاد بهشون نیاز داره و بدون وجود اونا نمی تونه ساخته بشه باید در constructor اش مقدار دهی شوند.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/5e86db0c-3d3f-4a3d-a68a-5ec0b47f544c/471bb9a3-5b12-422d-99ba-51de34d55ff1/Untitled.png)

مثلا ممکنه بنابر نیاز برنامه ، یک user در هنگام ساخته شدن نیاز به fullname داشته باشه

واقعیت دنیای نرم افزار

```ts
class Profile {
	name:string
	age:number
}
```

```ts
class User{
	private profile:Profile
	private degree:string
	constructor(profile:Profile){
		this.profile = profile;
	}
}
```

وابستگی های نوع بالا از نوع وابستگی هایی هست که توسط سازنده ایجاد می شود

مثلا انسانی که بدنیا میاد می تونه دندان نداشته باشه ولی باید قلب و مغز داشته باشه

ما ممکنه رفتار هایی داشته باشیم که قسمتی شون مربوط به resource ( موجودیت ، مدل ) ما بشه اما برای قسمت های دیگری نیز کاربرد داشته باشند

مانند عملیات لاگین که ممکنه قسمت چک کردن مطابقت username و password به مدل user مربوط بشه ولی قسمت ارسال توکن به کاربر مربوط نباشه

در این شرایطه که service ها بوجود میان این منطق ها رو داخل سرویس ها پیاده سازی می کنیم.

یا مثلا حساب بانکی یه موجودیته که فقط می تونه بگه موجودیش افزایش داشته یا نه ولی انتقال از یه حساب به حساب دیگه باید از طریق سرویس ها انجام بشه.

Observable behavior → دویدن

implementation details → پمپاژ قلب

