#### اصل معکوس سازی وابستگی ---------------

فرض کنید به جای اینکه PizzaStore را به کلاسی انتزاعی (منظور interface Pizza) ، به کلاس های غیر انتزاعی پیتزا وابسته کرده بودیم ، همون کاری که اول این فصل انجام داده بودیم.

وقتی بطور مستقیم یک کلاس غیر انتزاعی رو new می کنیم ، در واقع به یک کلاس غیر انتزاعی وابسته شدیم که این بده.

در این شرایط چون PizzaStore مستقیما هر object رو ایجاد کرده ، پس به همه ی کلاس های غیر انتزاعی پیتزا وابسته میشد.

![](./Images/Pasted%20image%2020240701081049.png)

این واضحه که کاهش وابستگی به کلاس های غیر انتزاعی خیلی خوبه ، ما اصلی به نام Dependency Inversion Principle یعنی اصل معکوس سازی وابستگی داریم ، که به ما برای تحقق کاهش وابستگی کمک میکنه.

این اصل میگه که به انتزاع وابسته باشیم نه به کلاس های غیر انتزاعی.

![](./Images/Pasted%20image%2020240701082035.png)

در نگاه اول تعریف این اصل بسیار شبیه به تعریف "برای قرارداد ها برنامه نویسی کنیم نه برای پیاده سازی ها" می باشد ؛ که البته این اصل قویی تر از این تعریف است ، اصل معکوس سازی وابستگی بیان میکنه که کامپوننت های سطح بالا نباید به کامپوننت های سطح پایین وابسته باشند ؛ بلکه هر دوی این کامپوننت ها باید به یک کلاس انتزاعی وابسته باشند.

اما این به چه معناست ؟

کلاس PizzaStore یه High-level Component هست و Pizza **implementation** یه Low-level component هست (کامپوننت هایی که جزئیات رو پیاده سازی می کنند ، low-level component اند ، به طور کل هنگام مقایسه دو کامپوننت برای فهمیدن اینکه کدام low-level و کدام high-level هست ، نگاه می کنیم تا ببینیم کدام جزئیات بیشتری دارد و اون میشه low-level) و همینطور که می بینیم کلاس PizzaStore به کلاس غیر انتزاعی Pizza وابسته هست.

اگه درختی که کشیدیم رو در نظر بگیریم ، از اون جهت میگیم سطح بالا چون PizzaStore در سطح بالا تری از درخت نسبت به Pizza قرار گرفته است.

این اصل به ما میگه که باید به انتزاع وابسته باشیم نه کلاس های غیر انتزاعی ؛

اما چه طور این امر رو محقق سازیم ؟

هدف ما بیرون کردن فرایند نمونه سازی سازی از کلاس ها به بیرون از کلاس PizzaStore می باشد ، همانطور که می دانیم ما قبلا این کار را با استفاده از Factory Method انجام داده ایم:

![](./Images/Pasted%20image%2020240701084050.png)

در واقع ، با قرار دادن یک کلاس انتزاعی پیتزا سر راه کلاس های Pizza و PizzaStore ، اون کلاس های پیتزا و PizzaStore رو به انتزاع وابسته کردیم.

در این شرایط ، چون ماژول های سطح پایین به یک انتزاع از ماژول سطح بالا وابسته شده اند ، از کلمه معکوس  در تعریف این اصل استفاده می کنیم. (اگر توی درختی که کشیدیم هم نگاه کنیم می بینیم که فلش پیتزا ها عوض شده که این یعنی معکوس سازی)

یعنی در واقع این ماژول سطح بالا هست که مشخص می کند چه می خواهد و ماژول های سطح پایین باید خود را با این درخواست ماژول سطح بالا وفق دهند ، نه اینکه ماژول سطح بالا خودش را با ماژول سطح پایین وفق دهد.

پس برای کد نویسی هم باید نگاه مون از بالا به پایین باشه ، یعنی اول کلاس PizzaStore رو توسعه میدیم و بعد میفهمیم که به انواعی از پیتزا نیاز داریم و خودمون رو وابسته به انتزاع می کنیم و بعد از آن کلاس های غیر انتزاعی رو توسعه میدیم ؛ یعنی دقیقا مثل درختی که کشیدیم پیش میریم.

